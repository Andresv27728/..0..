const fs = require("fs");
const path = require("path");
const matchCommand = require("../lib/matchCommand");

module.exports = async (sock, msg) => {
  const from = msg.key.remoteJid;
  const text = msg.message?.conversation || msg.message?.extendedTextMessage?.text;

  if (!matchCommand(text, "menu")) return;

  try {
    const hrs = new Date().getHours();
    const time = new Date().toLocaleTimeString("en-IN", { timeZone: "Asia/Kolkata" });

    let wish = "* ú·¥á è ·¥ús·¥á Ä*";
    if (hrs < 12) wish = "*…¢·¥è·¥è·¥Ö ·¥ç·¥è Ä…¥…™…¥…¢ ‚õÖ*";
    else if (hrs < 17) wish = "*…¢·¥è·¥è·¥Ö ·¥Ä“ì·¥õ·¥á Ä…¥·¥è·¥è…¥ üåû*";
    else if (hrs < 20) wish = "*…¢·¥è·¥è·¥Ö ·¥á·¥†·¥á…¥…™…¥…¢ üå•*";
    else wish = "*…¢·¥è·¥è·¥Ö …¥…™…¢ ú·¥õ üåô*";

    const imagePath = path.join(__dirname, "../media/menu.jpg");
    const image = fs.existsSync(imagePath)
      ? fs.readFileSync(imagePath)
      : { url: "https://telegra.ph/file/f32f089e7d7e8bc7e7e31.jpg" }; // fallback

    const caption = `‚ï≠‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïÆ
   ùôïùòºùôçùòº ùòΩùôäùôè
‚ï≠‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïØ
‚îÇ
‚îÇ ${wish}
‚îÇ         *‚åö ${time} IST*
‚îÇ
‚îÇ ‚ñ¢ *·¥è·¥°…¥·¥á Ä:* You
‚îÇ ‚ñ¢ *·¥†·¥á Äs…™·¥è…¥:* 2.1
‚îÇ ‚ñ¢ *·¥ç·¥è·¥Ö·¥á:* ·¥ò·¥ú ô ü…™·¥Ñ
‚îÇ ‚ñ¢ *·¥ò Ä·¥á“ì…™x:* *# / . ; !*
‚îÇ
‚îÇ      ‚ñé‚ñç‚ñå‚ñå‚ñâ‚ñè‚ñé‚ñå‚ñâ‚ñê‚ñè‚ñå‚ñé
‚îÇ      ‚ñé‚ñç‚ñå‚ñå‚ñâ‚ñè‚ñé‚ñå‚ñâ‚ñê‚ñè‚ñå‚ñé
‚îÇ       ¬©2025 ZaraMD
‚îÇ
‚ï∞‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïÆ
‚îÇ ‚ó© ·¥ç·¥á…¥·¥ú ‚ó™
‚ï≠‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïØ
‚îÇ
‚îÇ[ ·¥ç·¥á·¥Ö…™·¥Ä ]
‚îÇ ‚ñ¢ .s·¥è…¥…¢ .·¥†…™·¥Ö·¥á·¥è .…™…¥s·¥õ·¥Ä . è·¥õ
‚îÇ
‚îÇ[ ·¥Ñ·¥è…¥·¥†·¥á Ä·¥õ ]
‚îÇ ‚ñ¢ .…¢…™“ì .·¥ç·¥ò3 .·¥õ·¥õs .…™·¥ç…¢ .s·¥õ…™·¥Ñ·¥ã·¥á Ä
‚îÇ ‚ñ¢ .·¥Ä·¥õ·¥õ·¥ò .·¥õ·¥õ·¥ò .·¥ò ú·¥è·¥õ·¥è .2…™·¥ç…¢
‚îÇ
‚îÇ[ ·¥ç·¥Ä·¥ã·¥á Ä ]
‚îÇ ‚ñ¢ .·¥ç·¥è Ä·¥á·¥õx·¥õ .2·¥ç·¥è Ä·¥á·¥õx·¥õ .x·¥ç·¥á·¥Ö…™·¥Ä .·¥ç·¥ç·¥ò·¥Ä·¥Ñ·¥ã
‚îÇ
‚îÇ[ “ì·¥ú…¥ ]
‚îÇ ‚ñ¢ .·¥ä·¥è·¥ã·¥á .·¥ç·¥á·¥ç·¥á .«´ Ä .·¥Ñ ú·¥Ä…¥…¢·¥ás·¥Ä è .·¥õ Ä·¥ú·¥ç·¥òs·¥Ä è
‚îÇ ‚ñ¢ .·¥Ñ·¥è·¥ç·¥ò ü…™·¥ç·¥á…¥·¥õ
‚îÇ
‚îÇ[ s·¥á·¥Ä Ä·¥Ñ ú ]
‚îÇ ‚ñ¢ .·¥°…™·¥ã…™ . ü è Ä…™·¥Ñ .s ú·¥è·¥° .·¥ç·¥è·¥†…™·¥á .·¥°·¥á·¥Ä·¥õ ú·¥á Ä
‚îÇ
‚îÇ[ ·¥õ·¥Ä…¢ ]
‚îÇ ‚ñ¢ .·¥õ·¥Ä…¢·¥Ä ü ü .·¥õ·¥Ä…¢·¥Ä·¥Ö·¥ç…™…¥
‚îÇ
‚îÇ[ ·¥è·¥õ ú·¥á Ä ]
‚îÇ ‚ñ¢ .·¥Ä…¥…™·¥ç·¥á .·¥°·¥Ä ü ü·¥ò·¥Ä·¥ò·¥á Ä .ss .·¥Ö…™·¥Ñ·¥õ .s ú·¥è Ä·¥õ .·¥õ Ä·¥õ . Ä·¥á·¥ç·¥è·¥†·¥á ô…¢
‚îÇ
‚îÇ[ ·¥è·¥°…¥·¥á Ä ]
‚îÇ ‚ñ¢ .“ì·¥ú ü ü·¥á·¥†·¥Ä .·¥Ä·¥ú·¥õ·¥è ô…™·¥è . ô·¥Ä…¥ .·¥Ä·¥Ö·¥Ö
‚îÇ ‚ñ¢ .·¥ò Ä·¥è·¥ç·¥è·¥õ·¥á .·¥Ö·¥á·¥ç·¥è·¥õ·¥á .·¥ç·¥ú·¥õ·¥á .·¥ú…¥·¥ç·¥ú·¥õ·¥á .…™…¥·¥†…™·¥õ·¥á
‚îÇ
‚îÇ   ‚ùè ùò§ùò∞ùò•ùò¶ùò• ùò£ùò∫ ùòàùò£ùò©ùò™ùò≠ùòÆùòπùòª ‚ùè
‚ï∞‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïØ`;

    await sock.sendMessage(from, {
      image,
      caption,
    }, { quoted: msg });

  } catch (err) {
    console.error("‚ùå Menu plugin error:", err);
    await sock.sendMessage(from, { text: "‚ùå Failed to load menu." }, { quoted: msg });
  }
};
